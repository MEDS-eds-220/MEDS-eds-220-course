{
  "hash": "c4f9b0cafe982c37503aca85713b9072",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: Water conflicts in the Colorado River Basin\nsubtitle: Week 2 - Discussion section\nweek: 2\nimage: images/Tecopa_site2.JPG\nsidebar: false\njupyter: mpc-env-kernel\n---\n\n\nThis discussion section will guide you exploring data about water-related conflicts at the Colorado River Basin using data from the [U.S. Geological Survey (USGS)](https://www.usgs.gov). In this discussion section, you will:\n\n- Practice version control using git via the terminal\n- Discuss advantages and disadvantages about different methods of data loading\n- Use methods to work with `pandas.Series` of strings using the `.str` accessor\n\n## Setup\n\n:::{.callout-tip appearance=\"minimal\"}\n1. In the Taylor server, start a new JupyterLab session or access an active one.\n\n2. In the terminal, use `cd` to navigate into the `eds-220-sections` directory. Use `pwd` to verify `eds-220-sections` is your current working directory.\n\n3. Create a new Python Notebook inside your `eds-220-sections` directory and rename it to `section-2-co-basin-water-conflicts.ipynb`. \n\n4. Use the terminal to stage, commit, and push this file to the remote repository. Remember:\n    1. `git status` : check git status\n    2. `git add FILE-NAME` : stage updated file\n    3. `git status` : check git status again to confirm\n    4. `git commit -m \"Commit message\"` : commit with message\n    5. `git pull` : check local repo is up to date (best practice)\n    5. `git push` : push changes to upstream repository\n\n<p style=\"text-align: center;\">\n**CHECK IN WITH YOUR TEAM** \n</p>\n<p style=\"text-align: center;\">\n**MAKE SURE YOU'VE ALL SUCCESSFULLY SET UP YOUR NOTEBOOKS BEFORE CONTINUING**\n</p>\n:::\n\n## General directions\n:::{.callout-tip appearance=\"minimal\"}\n- Add comments in each one of your code cells. \n- On each exercise, include markdown cells in between your code cells to add titles and information.\n- Indications about when to commit and push changes are included, but you are encouraged to commit and push more often. \n:::\n\n## About the data\nFor these exercises we will use data about [Water Conflict and Crisis Events in the Colorado River Basin](https://www.sciencebase.gov/catalog/item/63acac09d34e92aad3ca1480) @holloman_coded_2023. This dataset is stored at [ScienceBase](https://www.sciencebase.gov/catalog/),a digital repository from the U.S. Geological Survey (USGS) created to share scientific data products and USGS resources. \n\nThe dataset is a CSV file containing conflict or crisis around water resource management in the Colorado River Basin. \nThe Colorado River Basin, inhabited by several Native American tribes for centuries, is a crucial water source in the southwestern United States and northern Mexico, supporting over 40 million people, extensive agricultural lands, and diverse ecosystems. \nIts management is vital due to the region's arid climate and the competing demands for water, leading to significant challenges related to water allocation and conservation. \n\n![Colorado River Basin.  U.S. Bureau of Reclamation. ](/discussion-sections-upcoming/images/co-river-basin.png)\n\n\n<!-- 10 minutes -->\n## 1. Archive exploration\nTake some time to look through the dataset's description in the ScienceBase repository. Look for the following information:\n\na. Where was the data collected from?\n<!-- \narticles from newspapers describing water-related events in geographic areas in the Basin\n-->\nb. During what time frame were the observations in the dataset collected?\n<!--\n2005-2021\n-->\nc. What was the author's perceived value of this dataset?\n<!--\n examining crisis on a continual basis toward identification of hotspots from conflict, identifying primary stakeholders, and who experiences crises.\n-->\n\n\nIn a markdown cell, use your answers to the previous questions to add a brief description of the dataset. Briefly discuss anything else that seems like relevant information. Include a citation, date of access, and a link to the archive. \n\n<p style=\"text-align: center;\">\n**check git status -> stage changes -> check git status -> commit with message -> pull -> push  changes**\n</p>\n\n<!-- 3 minutes -->\n## 2. Data loading\n\na. In class we have (so far) loaded data into our workspace either by downloading the file and storing a copy of it in our computer or by accessing the file directly through a URL. With your team, discuss what are, in general, the advantages and disadvantages of these two methods of data access. \n\nb. Import the `Colorado River Basin Water Conflict Table.csv` file [from the Science Base repository](https://www.sciencebase.gov/catalog/item/63acac09d34e92aad3ca1480) into your workspace. Name your data frame variable `df`.\n\n<p style=\"text-align: center;\">\n**CHECK IN WITH YOUR TEAM** \n</p>\n<p style=\"text-align: center;\">\n**MAKE SURE YOU'VE ALL SUCCESSFULLY LOADED THE DATA BEFORE CONTINUING**\n</p>\n\n<p style=\"text-align: center;\">\n**check git status -> stage changes -> check git status -> commit with message -> pull -> push  changes**\n</p>\n\n<!--\n\n::: {#ebd9ad4b .cell execution_count=1}\n``` {.python .cell-code}\nimport pandas as pd\n\ndf = pd.read_csv('data/Colorado River Basin Water Conflict Table.csv')\ndf.head(5)\n```\n\n::: {.cell-output .cell-output-display execution_count=1}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Event</th>\n      <th>Search Source</th>\n      <th>Newspaper</th>\n      <th>Article Title</th>\n      <th>Duplicate</th>\n      <th>Report Date</th>\n      <th>Report Year</th>\n      <th>Event Date</th>\n      <th>Event Day</th>\n      <th>Event Month</th>\n      <th>...</th>\n      <th>Article Text Search - water rights</th>\n      <th>Article Text Search - intergovernmental</th>\n      <th>Article Text Search - water transfers</th>\n      <th>Article Text Search - navigation</th>\n      <th>Article Text Search - fish</th>\n      <th>Article Text Search - invasive</th>\n      <th>Article Text Search - diversion</th>\n      <th>Article Text Search - water diversion</th>\n      <th>Article Text Search - instream</th>\n      <th>Article Text Search - aquatic</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>1</td>\n      <td>USGS1-50.docx</td>\n      <td>The Durango Herald (Colorado)</td>\n      <td>Tribes assert water rights on Colorado River B...</td>\n      <td>False</td>\n      <td>7-Apr-22</td>\n      <td>2022.0</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>4.0</td>\n      <td>...</td>\n      <td>17</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>2</td>\n      <td>USGS1-50.docx</td>\n      <td>Journal, The (Cortez, Dolores, Mancos, CO)</td>\n      <td>Native American tribes assert water rights on ...</td>\n      <td>False</td>\n      <td>7-Apr-22</td>\n      <td>2022.0</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>4.0</td>\n      <td>...</td>\n      <td>17</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>3</td>\n      <td>USGS1-50.docx</td>\n      <td>The Salt Lake Tribune</td>\n      <td>'Very positive change.' New Utah law will be a...</td>\n      <td>False</td>\n      <td>17-Mar-22</td>\n      <td>2022.0</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>3.0</td>\n      <td>...</td>\n      <td>12</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>12</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>4</td>\n      <td>USGS1-50.docx</td>\n      <td>Casa Grande Dispatch (AZ)</td>\n      <td>Legislation would let an Arizona tribe lease C...</td>\n      <td>False</td>\n      <td>11-Dec-21</td>\n      <td>2021.0</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>12.0</td>\n      <td>...</td>\n      <td>6</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>5</td>\n      <td>USGS1-50.docx</td>\n      <td>The Aspen Times (Colorado)</td>\n      <td>Historically excluded from Colorado River poli...</td>\n      <td>False</td>\n      <td>19-Dec-21</td>\n      <td>2021.0</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>11.0</td>\n      <td>...</td>\n      <td>18</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n  </tbody>\n</table>\n<p>5 rows Ã— 48 columns</p>\n</div>\n```\n:::\n:::\n\n\n-->\n\n## 3. Preliminary data exploration\n\nWrite a list with at least four ways in which you coud gain preliminary information about this dataset and why these are relevant.\n\n<!--\n\n::: {#9da14ee4 .cell execution_count=2}\n``` {.python .cell-code}\n# df.head()\n# df.shape\n# df.columns\n# df.Stakeholders.unique()\n```\n:::\n\n\n::: {#06f6efce .cell execution_count=3}\n``` {.python .cell-code}\n(df['State'].dropna()\n            .str.split(';', expand=True)\n            .stack()\n            .str.strip()\n            .value_counts())\n```\n\n::: {.cell-output .cell-output-display execution_count=3}\n```\nAZ    87\nCO    45\nUT    40\nNV    19\nCA    16\nNM    13\nWY     8\nOH     1\nTX     1\nName: count, dtype: int64\n```\n:::\n:::\n\n\n-->\n\n## 4. String accessor for `pandas.Series`\n\nIn the following exercises we will work with `pandas.Series` whose values are strings. This is a common scenario, so `pandas` has special [string methods](https://pandas.pydata.org/docs/user_guide/text.html#string-methods) for this kind of series. These methods are accessed via the **`str` accessor**. **Accessors** provide additional functionality for working with specific kinds of data (in this case, strings). \n\n\n1. Carefully read the code below. We'll use some of it soon.\n\n::: {#1aca40df .cell execution_count=4}\n``` {.python .cell-code}\nimport pandas as pd \nimport numpy as np\n\n# Example series\ns = pd.Series(['California; Nevada', 'Arizona', np.nan, 'Utah; Colorado'])\ns\n```\n\n::: {.cell-output .cell-output-display execution_count=4}\n```\n0    California; Nevada\n1               Arizona\n2                   NaN\n3        Utah; Colorado\ndtype: object\n```\n:::\n:::\n\n\n::: {#332fe457 .cell execution_count=5}\n``` {.python .cell-code}\n# str accessor (doesn't do anything by itself)\ns.str\n```\n\n::: {.cell-output .cell-output-display execution_count=5}\n```\n<pandas.core.strings.accessor.StringMethods at 0x144db2190>\n```\n:::\n:::\n\n\n::: {#b8666025 .cell execution_count=6}\n``` {.python .cell-code}\n# Use str accessor with additional methods to perform string operations\n# .split splits strings by ';' and expands output into separate columns\ns.str.split(';', expand=True)\n```\n\n::: {.cell-output .cell-output-display execution_count=6}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>0</th>\n      <th>1</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>California</td>\n      <td>Nevada</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>Arizona</td>\n      <td>None</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>Utah</td>\n      <td>Colorado</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n## Examine state codes\n\nOur goal today is to **find which states are reported in the dataset as having a water conflict**. \n\n1. What are the unique values in the `States` column? What could be a challenge to writing code to find which states are listed (without repetition)? Remember to write longer answers in mardown cells, not as comments.\n\n::: {#0d68fb5d .cell execution_count=7}\n``` {.python .cell-code}\nprint(df['State'].unique())\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n['CO' 'UT' nan 'AZ' 'OH; UT' 'AZ; CO; NM; UT' 'CA' 'AZ; UT' 'AZ; NV'\n 'CO; UT; WY; NM' 'AZ; CA' 'UT; AZ' 'CO; WY' 'NV; AZ' 'CO; AZ'\n 'AZ; CA; CO; NV; NM; UT; WY' 'AZ; CA; NV' 'NV' 'NM' 'UT; CO; WY'\n 'CA; NV; AZ' 'AZ; NM' 'WY; UT; CO' 'TX']\n```\n:::\n:::\n\n\n::: {#c9cb350c .cell execution_count=8}\n``` {.python .cell-code}\nfor x in df['State'].unique():\n    print(x)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nCO\nUT\nnan\nAZ\nOH; UT\nAZ; CO; NM; UT\nCA\nAZ; UT\nAZ; NV\nCO; UT; WY; NM\nAZ; CA\nUT; AZ\nCO; WY\nNV; AZ\nCO; AZ\nAZ; CA; CO; NV; NM; UT; WY\nAZ; CA; NV\nNV\nNM\nUT; CO; WY\nCA; NV; AZ\nAZ; NM\nWY; UT; CO\nTX\n```\n:::\n:::\n\n\n## Brainstorm\n\n1. Individually, write step-by-step instructions on how you would create a list (without repetition) with the state codes in which a water conflict reported has been reported. It's ok if you don't know how to code each step - it's more important to have an idea of what we'll do.\n\n2. Discuss your ideas on how to approach this problem with your team.\n\nThe next exercises will guide you through finding the state codes in the dataset. There are *many* ways of extracting this information. The one presented here might not be the same way you thought about doing it - that's ok! This one was designed to practice using the `.str` accessor in a `pandas.Series`.\n\n## Drop NAs\n\nUse the `dropna()` method on the State column to create a new `pandas.Series` called `states` without NAs. Check there are no NAs in the new `states` series.\n\n::: {#7b7fe13d .cell execution_count=9}\n``` {.python .cell-code}\nstates = df['State'].dropna()\nstates\n```\n\n::: {.cell-output .cell-output-display execution_count=9}\n```\n0          CO\n1          CO\n2          UT\n5          AZ\n11     OH; UT\n        ...  \n263        CO\n264        CO\n265    AZ; CA\n266        AZ\n267        AZ\nName: State, Length: 178, dtype: object\n```\n:::\n:::\n\n\n::: {#b8b1a1b5 .cell execution_count=10}\n``` {.python .cell-code}\nstates.hasnans\n```\n\n::: {.cell-output .cell-output-display execution_count=10}\n```\nFalse\n```\n:::\n:::\n\n\n## Split strings\n\n## Stack the data frame\n\n## Value counts\n\n## Method chaining\n\n::: {#04c19624 .cell execution_count=11}\n``` {.python .cell-code}\n# stakeholders = (df['Stakeholders'].dropna()\n#                      .str.split(',', expand=True)\n#                      .apply(lambda x: x.str.strip())\n#                      .values\n#                      .ravel())\n\n# stakeholders = pd.unique(stakeholders)\n# print(stakeholders)\n```\n:::\n\n\n",
    "supporting": [
      "ds-2-water-crisis-exploration_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}