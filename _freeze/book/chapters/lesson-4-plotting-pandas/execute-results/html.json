{
  "hash": "2d591a3aa871da4344573c854444874e",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntoc-title: In this lesson\n---\n\n\n\n\n# 3 Basic plotting\nIn this lesson we will learn to use the `plot()` method of a `pandas.DataFrame` to create simple exploratory graphs from tabular data. \n\n## Learning objectives\nBy the end of this lesson students will be able to: \n\n- Obtain and interpret preliminary information about a `pandas.DataFrame` using methods such as `info()` (structure), `describe()` (summary statistics), `nunique()` (unique value counts), `unique()` (distinct values), `and value_counts()` (frequency counts)\n- Create simple exploratory plots using the `plot()` method for `pandas.DataFrames` to visualize trends and distributions\n- Understand the concept of performing operations on a `pandas.DataFrame` in-place\n- Apply method chaining to enable concise and readable code\n\n## About the data\n\nIn this lesson we will reuse the annual estimates of bird species abundance in four coastal wetlands along the California coast that we used in the previous lesson on subsetting a `pandas.DataFrame`. This dataset was derived for education purposes for this course from the [UCSB SONGS Mitigation Monitoring: Wetland Performance Standard - Bird Abundance and Species Richness dataset](https://portal.edirepository.org/nis/mapbrowse?packageid=edi.649.6) @schroeter_ucsb_2024. \nThe SONGS dataset was collected as part of the [San Onofre Nuclear Generating Station (SONGS) San Dieguito Wetland Restoration monitoring program](https://marinemitigation.msi.ucsb.edu). \n\nThe annual bird species abundance estimates is a CSV file with 13 columns and 14 rows. You can see the first three rows below.\n<!-- TODO: add link to other lesson. Add pictures of birds -->\n\n::: {#00eb2cc6 .cell execution_count=1}\n\n::: {.cell-output .cell-output-display execution_count=1}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>year</th>\n      <th>CSM_winter</th>\n      <th>CSM_spring</th>\n      <th>CSM_fall</th>\n      <th>MUL_winter</th>\n      <th>MUL_spring</th>\n      <th>MUL_fall</th>\n      <th>SDW_winter</th>\n      <th>SDW_spring</th>\n      <th>SDW_fall</th>\n      <th>TJE_winter</th>\n      <th>TJE_spring</th>\n      <th>TJE_fall</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>2010</td>\n      <td>39.0</td>\n      <td>40.0</td>\n      <td>50.0</td>\n      <td>45.0</td>\n      <td>NaN</td>\n      <td>61.0</td>\n      <td>NaN</td>\n      <td>75.0</td>\n      <td>85.0</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>81.0</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>2011</td>\n      <td>48.0</td>\n      <td>44.0</td>\n      <td>NaN</td>\n      <td>58.0</td>\n      <td>52.0</td>\n      <td>NaN</td>\n      <td>78.0</td>\n      <td>74.0</td>\n      <td>NaN</td>\n      <td>67.0</td>\n      <td>70.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>2012</td>\n      <td>51.0</td>\n      <td>43.0</td>\n      <td>49.0</td>\n      <td>57.0</td>\n      <td>58.0</td>\n      <td>53.0</td>\n      <td>71.0</td>\n      <td>72.0</td>\n      <td>73.0</td>\n      <td>70.0</td>\n      <td>63.0</td>\n      <td>69.0</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\nThe four wetlands where the bird surveys occured are Carpinteria Salt Marsh (CSM),  Mugu Lagoon (MUL), the San Dieguito Wetland (SDW), and the Tijuana Estuary (TJE). The values from the second column to the last column correspond to the number of different bird species recorded across the survey sites in each wetland during winter, spring, and fall of a given year. For example, the `CSM_fall` column has the number of species recorded in fall at Carpinteria Salt Marsh across years. The `year` column corresponds to the calendar year on which the data was collected. Surveys have happened yearly from 2010 to 2023. \n\n\n## `plot()` method\n\nLet us start by loading the data:\n\n```python\nimport pandas as pd\n\n# Read in file\ndf = pd.read_csv('data/wetlands_seasonal_bird_diversity.csv')\n\n# Check the first 5 rows\ndf.head()\n```\n\n::: {#b1fa0bc6 .cell execution_count=2}\n\n::: {.cell-output .cell-output-display execution_count=2}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>year</th>\n      <th>CSM_winter</th>\n      <th>CSM_spring</th>\n      <th>CSM_fall</th>\n      <th>MUL_winter</th>\n      <th>MUL_spring</th>\n      <th>MUL_fall</th>\n      <th>SDW_winter</th>\n      <th>SDW_spring</th>\n      <th>SDW_fall</th>\n      <th>TJE_winter</th>\n      <th>TJE_spring</th>\n      <th>TJE_fall</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>2010</td>\n      <td>39.0</td>\n      <td>40.0</td>\n      <td>50.0</td>\n      <td>45.0</td>\n      <td>NaN</td>\n      <td>61.0</td>\n      <td>NaN</td>\n      <td>75.0</td>\n      <td>85.0</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>81.0</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>2011</td>\n      <td>48.0</td>\n      <td>44.0</td>\n      <td>NaN</td>\n      <td>58.0</td>\n      <td>52.0</td>\n      <td>NaN</td>\n      <td>78.0</td>\n      <td>74.0</td>\n      <td>NaN</td>\n      <td>67.0</td>\n      <td>70.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>2012</td>\n      <td>51.0</td>\n      <td>43.0</td>\n      <td>49.0</td>\n      <td>57.0</td>\n      <td>58.0</td>\n      <td>53.0</td>\n      <td>71.0</td>\n      <td>72.0</td>\n      <td>73.0</td>\n      <td>70.0</td>\n      <td>63.0</td>\n      <td>69.0</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>2013</td>\n      <td>42.0</td>\n      <td>46.0</td>\n      <td>38.0</td>\n      <td>60.0</td>\n      <td>58.0</td>\n      <td>62.0</td>\n      <td>69.0</td>\n      <td>70.0</td>\n      <td>70.0</td>\n      <td>69.0</td>\n      <td>74.0</td>\n      <td>64.0</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>2014</td>\n      <td>38.0</td>\n      <td>43.0</td>\n      <td>45.0</td>\n      <td>49.0</td>\n      <td>52.0</td>\n      <td>57.0</td>\n      <td>61.0</td>\n      <td>78.0</td>\n      <td>71.0</td>\n      <td>60.0</td>\n      <td>81.0</td>\n      <td>62.0</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\nA `pandas.DataFrame` has a [built-in method `plot()`](https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.plot.html) for plotting. \nWhen we call it without specifying any other parameters `plot()` creates one line plot for each of the columns with numeric data. \n\n::: {#a44c2974 .cell execution_count=3}\n``` {.python .cell-code}\n# Default plot(): one line plot per column with numeric data\ndf.plot()\n```\n\n::: {.cell-output .cell-output-display}\n![](lesson-4-plotting-pandas_files/figure-html/cell-4-output-1.png){width=583 height=411}\n:::\n:::\n\n\nAs we can see, this doesn't make much sense! In particular, look at the x-axis. The default for `plot` is to use the values of the index as the x-axis values. Let's see some examples about how to improve this situation.\n\n## Line plots\n\nWe can make a line plot of one column against another by using the following the general syntax:\n\n```python\ndf.plot(x='x_values_column', y='y_values_column')\n```\n#### Example\n\nIf we want to plot the bird surveys at Carpinteria Salt Marsh across years we can do:\n\n::: {#c96fb3fd .cell execution_count=4}\n``` {.python .cell-code}\n# Birds species registered during winter at CSM yearly\ndf.plot(x='year', y='CSM_winter')\n```\n\n::: {.cell-output .cell-output-display}\n![](lesson-4-plotting-pandas_files/figure-html/cell-5-output-1.png){width=579 height=429}\n:::\n:::\n\n\nWe can do some basic customization specifying other parameters of the `plot()` method. Some basic ones are:\n\n- `title`: title to use for the plot.\n- `xlabel`: name to use for the x-label on x-axis\n- `ylabel`: bame to use for the y-label on y-axis\n- `color`: change the color of our plot\n- `legend`: boolean value `True` or `False`. `True` (default) includes the legend, `False` removes the legend\n\nIn action:\n\n::: {#d73a07be .cell execution_count=5}\n``` {.python .cell-code}\ndf.plot(x='year', \n        y='CSM_winter',\n        title='Bird species registered during winter at Carpinteria Salt Marsh',\n        xlabel='Year',\n        ylabel='Number of bird species',\n        color='green',\n        legend=False\n        )\n```\n\n::: {.cell-output .cell-output-display}\n![](lesson-4-plotting-pandas_files/figure-html/cell-6-output-1.png){width=597 height=449}\n:::\n:::\n\n\nYou can see all the [optional parameters for the `plot()` function in the documentation](https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.plot.html).\n\n:::{.callout-tip}\n## Check-in\nPlot a graph of the bird surveys at Mugu Lagoon with respect to the years. Include some basic customization.\n:::\n\n## Multiple line plots\n\nWe can plot multiple line plots by updating these parameters in the `plot()` method:\n\n- `y` : a list of column names that will be plotted against the x-axis\n- `color`: a dictionary `{'column_1' : 'color_1', 'column_2':'color_2}` specifying the color of each column's line plot\n\n#### Example\n\nLet's say we want to compare the bird surveys at the Tijuana Estuary during spring and fall across years. \n\n::: {#613d10cb .cell execution_count=6}\n``` {.python .cell-code}\ndf.plot(x='year', \n        y=['TJE_spring', 'TJE_fall'],\n        title = 'Seasonal bird surveys at Tijuana Estuary',\n        xlabel='Year',\n        ylabel='Number of bird species',        \n        color = {'TJE_spring':'#F48FB1',\n                 'TJE_fall': '#AB47BC'\n                 }\n        )\n```\n\n::: {.cell-output .cell-output-display}\n![](lesson-4-plotting-pandas_files/figure-html/cell-7-output-1.png){width=585 height=449}\n:::\n:::\n\n\n<!--It is not possible to rename the labels in the legend only using the plot() method and without updating the column names.-->\n\nNotice that for specifying the colors we used a **HEX code**, this gives us more control over how our graph looks.\n\n\nWe can also create separate plots for each column by setting the `subset` to `True`.\n\n::: {#139050f6 .cell execution_count=7}\n``` {.python .cell-code}\ndf.plot(x='year', \n        y=['TJE_spring', 'TJE_fall'],\n        title = 'Seasonal bird surveys at Tijuana Estuary',\n        xlabel='Year',\n        ylabel='Number of bird species',        \n        color = {'TJE_spring':'#F48FB1',\n                 'TJE_fall': '#AB47BC'\n                 },\n        subplots=True\n        )\n```\n\n::: {.cell-output .cell-output-display execution_count=7}\n```\narray([<Axes: xlabel='Year', ylabel='Number of bird species'>,\n       <Axes: xlabel='Year', ylabel='Number of bird species'>],\n      dtype=object)\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](lesson-4-plotting-pandas_files/figure-html/cell-8-output-2.png){width=585 height=477}\n:::\n:::\n\n\n## Updating the index\n\n**Updating the index** of our data frame's to be something other than the default integers numbering the rows can be a useful operation for plotting. \nTo update the index we use the [`set_index()`](https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.set_index.html) method for a `pandas.DataFrame`. \nThe general syntax for setting a column as the new index is:\n\n```python\ndf.set_index('column_name')\n```\nwhere `column_name` is the name of the column in the data frame `df` we want to use as new index.\n\nThis operation does not happen in-place. \n\n- A funciton **acting in-place** means that our original data frame is modified. \n- If the function **does not act in-place**, a new data frame is created and the original is not modified. \n\nIf we wanted to update our `df` data frame we could do an **explicit assignment** to reassign the output of `set_index()` to `df`:\n\n```python\ndf = df.set_index('column_name')\n```\n\nor use the optional `inplace` parameter:\n\n```python\ndf.set_index('column_name', inplace=True)\n```\n\n:::{.callout-caution}\n## Avoid using the `inplace=True` argument, favor explicit variable assignments\nCheck the information about the `inplace` parameter in the [`set_index()` documentation](https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.set_index.html). You will often see the `inplace` parameter in methods for `pandas.DataFrames`. The best practice is to avoid `inplace=True` for better readability and maintainable code. Explicitly assigning the result to a new variable or the same variable makes it clear that an operation has occurred.\n:::\n\n#### Example\n\nIn all our previous examples we used the year column as the x-axis. Since all our bird survey variables are dependent on the year, it makes sense to use the year column as the index of the data frame:\n\n::: {#9d435a02 .cell execution_count=8}\n``` {.python .cell-code}\n# Update index to be the year column\ndf = df.set_index('year')\ndf.head()\n```\n\n::: {.cell-output .cell-output-display execution_count=8}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>CSM_winter</th>\n      <th>CSM_spring</th>\n      <th>CSM_fall</th>\n      <th>MUL_winter</th>\n      <th>MUL_spring</th>\n      <th>MUL_fall</th>\n      <th>SDW_winter</th>\n      <th>SDW_spring</th>\n      <th>SDW_fall</th>\n      <th>TJE_winter</th>\n      <th>TJE_spring</th>\n      <th>TJE_fall</th>\n    </tr>\n    <tr>\n      <th>year</th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>2010</th>\n      <td>39.0</td>\n      <td>40.0</td>\n      <td>50.0</td>\n      <td>45.0</td>\n      <td>NaN</td>\n      <td>61.0</td>\n      <td>NaN</td>\n      <td>75.0</td>\n      <td>85.0</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>81.0</td>\n    </tr>\n    <tr>\n      <th>2011</th>\n      <td>48.0</td>\n      <td>44.0</td>\n      <td>NaN</td>\n      <td>58.0</td>\n      <td>52.0</td>\n      <td>NaN</td>\n      <td>78.0</td>\n      <td>74.0</td>\n      <td>NaN</td>\n      <td>67.0</td>\n      <td>70.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>2012</th>\n      <td>51.0</td>\n      <td>43.0</td>\n      <td>49.0</td>\n      <td>57.0</td>\n      <td>58.0</td>\n      <td>53.0</td>\n      <td>71.0</td>\n      <td>72.0</td>\n      <td>73.0</td>\n      <td>70.0</td>\n      <td>63.0</td>\n      <td>69.0</td>\n    </tr>\n    <tr>\n      <th>2013</th>\n      <td>42.0</td>\n      <td>46.0</td>\n      <td>38.0</td>\n      <td>60.0</td>\n      <td>58.0</td>\n      <td>62.0</td>\n      <td>69.0</td>\n      <td>70.0</td>\n      <td>70.0</td>\n      <td>69.0</td>\n      <td>74.0</td>\n      <td>64.0</td>\n    </tr>\n    <tr>\n      <th>2014</th>\n      <td>38.0</td>\n      <td>43.0</td>\n      <td>45.0</td>\n      <td>49.0</td>\n      <td>52.0</td>\n      <td>57.0</td>\n      <td>61.0</td>\n      <td>78.0</td>\n      <td>71.0</td>\n      <td>60.0</td>\n      <td>81.0</td>\n      <td>62.0</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {#bb97916f .cell execution_count=9}\n``` {.python .cell-code}\n# Simple plot of Carpinteria Salt Marsh winter surveys\ndf.plot(y='CSM_winter')\n```\n\n::: {.cell-output .cell-output-display}\n![](lesson-4-plotting-pandas_files/figure-html/cell-10-output-1.png){width=579 height=429}\n:::\n:::\n\n\n needed, we can reset the index to be the numbering of the rows:\n\n::: {#636204c5 .cell execution_count=10}\n``` {.python .cell-code}\ndf = df.reset_index()\ndf.head()\n```\n\n::: {.cell-output .cell-output-display execution_count=10}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>year</th>\n      <th>CSM_winter</th>\n      <th>CSM_spring</th>\n      <th>CSM_fall</th>\n      <th>MUL_winter</th>\n      <th>MUL_spring</th>\n      <th>MUL_fall</th>\n      <th>SDW_winter</th>\n      <th>SDW_spring</th>\n      <th>SDW_fall</th>\n      <th>TJE_winter</th>\n      <th>TJE_spring</th>\n      <th>TJE_fall</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>2010</td>\n      <td>39.0</td>\n      <td>40.0</td>\n      <td>50.0</td>\n      <td>45.0</td>\n      <td>NaN</td>\n      <td>61.0</td>\n      <td>NaN</td>\n      <td>75.0</td>\n      <td>85.0</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>81.0</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>2011</td>\n      <td>48.0</td>\n      <td>44.0</td>\n      <td>NaN</td>\n      <td>58.0</td>\n      <td>52.0</td>\n      <td>NaN</td>\n      <td>78.0</td>\n      <td>74.0</td>\n      <td>NaN</td>\n      <td>67.0</td>\n      <td>70.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>2012</td>\n      <td>51.0</td>\n      <td>43.0</td>\n      <td>49.0</td>\n      <td>57.0</td>\n      <td>58.0</td>\n      <td>53.0</td>\n      <td>71.0</td>\n      <td>72.0</td>\n      <td>73.0</td>\n      <td>70.0</td>\n      <td>63.0</td>\n      <td>69.0</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>2013</td>\n      <td>42.0</td>\n      <td>46.0</td>\n      <td>38.0</td>\n      <td>60.0</td>\n      <td>58.0</td>\n      <td>62.0</td>\n      <td>69.0</td>\n      <td>70.0</td>\n      <td>70.0</td>\n      <td>69.0</td>\n      <td>74.0</td>\n      <td>64.0</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>2014</td>\n      <td>38.0</td>\n      <td>43.0</td>\n      <td>45.0</td>\n      <td>49.0</td>\n      <td>52.0</td>\n      <td>57.0</td>\n      <td>61.0</td>\n      <td>78.0</td>\n      <td>71.0</td>\n      <td>60.0</td>\n      <td>81.0</td>\n      <td>62.0</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n:::{.callout-tip}\n## Check-in\n1. Without running the code, give a step-by-step breakdown of what this code is doing:\n```python\ndf.set_index('year').loc[:,'SDW_winter':'TJE_fall'].plot()\n```\n\n2. Is this code modifying the data frame `df`? Why or why not?\n\n3. Run the code and examine the graph. Do we have all the necessary information to make sure it makes sense to directly compare the surveys at these different sites? \n<!--The different sites have very different sizes and the surveys show the total number of birds identified, not the number of birds relative to the extent. -->\n:::\n\n## Method chaining\nThe code used in the check-in\n\n```python\ndf.set_index('year').loc[:,'SDW_winter':'TJE_fall'].plot()\n```\n\nis an example of **method chaining**. Each method in the chain returns an object (typically the same object), allowing the next method to be called directly on the result.  This is a powerful technique that makes code concise and readable. \n\nAn alternative to the previous code chaining could have been:\n```python\nyear_index_df = df.set_index('year')\nsubset_df = year_index_df.loc[:,'SDW_winter':'TJE_fall']\nsubset_df.plot()\n```\n\nWhile this accomplishes the same output, several variables are created along the way and it can be difficult to keep track of what is what.  Method chaining is particularly useful in `pandas` for streamlining multiple data manipulations. However, it should be used with care to avoid overly complex and difficult-to-debug code!\n\nWe will move on to another dataset for the rest of this lesson.\n\n\n\n## About the data\n\nFor the next plots we will use the  Palmer Penguins dataset @palmerpenguins developed by Drs. Allison Horst, Alison Hill and Kristen Gorman. This dataset contains size measurements for three penguin species in the Palmer Archipelago, Antarctica. \n\n![The Palmer Archipelago penguins. Artwork by Dr. Allison Horst.](/book/images/lesson-4/lter_penguins.png)\n\nThe dataset has 344 rows and 8 columns. We can see it's first three rows below:\n\n::: {#3e882053 .cell execution_count=11}\n\n::: {.cell-output .cell-output-display execution_count=11}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>species</th>\n      <th>island</th>\n      <th>bill_length_mm</th>\n      <th>bill_depth_mm</th>\n      <th>flipper_length_mm</th>\n      <th>body_mass_g</th>\n      <th>sex</th>\n      <th>year</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>Adelie</td>\n      <td>Torgersen</td>\n      <td>39.1</td>\n      <td>18.7</td>\n      <td>181.0</td>\n      <td>3750.0</td>\n      <td>male</td>\n      <td>2007</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>Adelie</td>\n      <td>Torgersen</td>\n      <td>39.5</td>\n      <td>17.4</td>\n      <td>186.0</td>\n      <td>3800.0</td>\n      <td>female</td>\n      <td>2007</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>Adelie</td>\n      <td>Torgersen</td>\n      <td>40.3</td>\n      <td>18.0</td>\n      <td>195.0</td>\n      <td>3250.0</td>\n      <td>female</td>\n      <td>2007</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n## Data exploration\n\nThe data is usually accessed through the `palmerpenguins` R data package @palmerpenguins. Today we will access the CSV directly into Python using the URL: [https://raw.githubusercontent.com/allisonhorst/palmerpenguins/main/inst/extdata/penguins.csv]()\n\n\nLet's start by reading in the data:\n\n::: {#63525114 .cell execution_count=12}\n``` {.python .cell-code}\n# Read in data\nURL = 'https://raw.githubusercontent.com/allisonhorst/palmerpenguins/main/inst/extdata/penguins.csv'\npenguins = pd.read_csv(URL)\n\npenguins.head()\n```\n\n::: {.cell-output .cell-output-display execution_count=12}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>species</th>\n      <th>island</th>\n      <th>bill_length_mm</th>\n      <th>bill_depth_mm</th>\n      <th>flipper_length_mm</th>\n      <th>body_mass_g</th>\n      <th>sex</th>\n      <th>year</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>Adelie</td>\n      <td>Torgersen</td>\n      <td>39.1</td>\n      <td>18.7</td>\n      <td>181.0</td>\n      <td>3750.0</td>\n      <td>male</td>\n      <td>2007</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>Adelie</td>\n      <td>Torgersen</td>\n      <td>39.5</td>\n      <td>17.4</td>\n      <td>186.0</td>\n      <td>3800.0</td>\n      <td>female</td>\n      <td>2007</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>Adelie</td>\n      <td>Torgersen</td>\n      <td>40.3</td>\n      <td>18.0</td>\n      <td>195.0</td>\n      <td>3250.0</td>\n      <td>female</td>\n      <td>2007</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>Adelie</td>\n      <td>Torgersen</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>2007</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>Adelie</td>\n      <td>Torgersen</td>\n      <td>36.7</td>\n      <td>19.3</td>\n      <td>193.0</td>\n      <td>3450.0</td>\n      <td>female</td>\n      <td>2007</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\nAnd getting some preliminary information:\n\n::: {#b1922125 .cell execution_count=13}\n``` {.python .cell-code}\n# Check column data types and NA values\npenguins.info()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n<class 'pandas.core.frame.DataFrame'>\nRangeIndex: 344 entries, 0 to 343\nData columns (total 8 columns):\n #   Column             Non-Null Count  Dtype  \n---  ------             --------------  -----  \n 0   species            344 non-null    object \n 1   island             344 non-null    object \n 2   bill_length_mm     342 non-null    float64\n 3   bill_depth_mm      342 non-null    float64\n 4   flipper_length_mm  342 non-null    float64\n 5   body_mass_g        342 non-null    float64\n 6   sex                333 non-null    object \n 7   year               344 non-null    int64  \ndtypes: float64(4), int64(1), object(3)\nmemory usage: 21.6+ KB\n```\n:::\n:::\n\n\n::: {#93694db5 .cell execution_count=14}\n``` {.python .cell-code}\n# Simple statistics about numeric columns\npenguins.describe()\n```\n\n::: {.cell-output .cell-output-display execution_count=14}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>bill_length_mm</th>\n      <th>bill_depth_mm</th>\n      <th>flipper_length_mm</th>\n      <th>body_mass_g</th>\n      <th>year</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>count</th>\n      <td>342.000000</td>\n      <td>342.000000</td>\n      <td>342.000000</td>\n      <td>342.000000</td>\n      <td>344.000000</td>\n    </tr>\n    <tr>\n      <th>mean</th>\n      <td>43.921930</td>\n      <td>17.151170</td>\n      <td>200.915205</td>\n      <td>4201.754386</td>\n      <td>2008.029070</td>\n    </tr>\n    <tr>\n      <th>std</th>\n      <td>5.459584</td>\n      <td>1.974793</td>\n      <td>14.061714</td>\n      <td>801.954536</td>\n      <td>0.818356</td>\n    </tr>\n    <tr>\n      <th>min</th>\n      <td>32.100000</td>\n      <td>13.100000</td>\n      <td>172.000000</td>\n      <td>2700.000000</td>\n      <td>2007.000000</td>\n    </tr>\n    <tr>\n      <th>25%</th>\n      <td>39.225000</td>\n      <td>15.600000</td>\n      <td>190.000000</td>\n      <td>3550.000000</td>\n      <td>2007.000000</td>\n    </tr>\n    <tr>\n      <th>50%</th>\n      <td>44.450000</td>\n      <td>17.300000</td>\n      <td>197.000000</td>\n      <td>4050.000000</td>\n      <td>2008.000000</td>\n    </tr>\n    <tr>\n      <th>75%</th>\n      <td>48.500000</td>\n      <td>18.700000</td>\n      <td>213.000000</td>\n      <td>4750.000000</td>\n      <td>2009.000000</td>\n    </tr>\n    <tr>\n      <th>max</th>\n      <td>59.600000</td>\n      <td>21.500000</td>\n      <td>231.000000</td>\n      <td>6300.000000</td>\n      <td>2009.000000</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\nWe can also subset the dataframe to get information about a particular column or groups of columns:\n\n::: {#56236f58 .cell execution_count=15}\n``` {.python .cell-code}\n# Count unique values in categorical columns and year\npenguins[['species', 'island', 'sex', 'year']].nunique()\n```\n\n::: {.cell-output .cell-output-display execution_count=15}\n```\nspecies    3\nisland     3\nsex        2\nyear       3\ndtype: int64\n```\n:::\n:::\n\n\n::: {#9a80ffc8 .cell execution_count=16}\n``` {.python .cell-code}\n# Get unique values in species column\npenguins.species.unique()\n```\n\n::: {.cell-output .cell-output-display execution_count=16}\n```\narray(['Adelie', 'Gentoo', 'Chinstrap'], dtype=object)\n```\n:::\n:::\n\n\n::: {#de349690 .cell execution_count=17}\n``` {.python .cell-code}\n# Number of values per unique value in species column\npenguins.species.value_counts()\n```\n\n::: {.cell-output .cell-output-display execution_count=17}\n```\nspecies\nAdelie       152\nGentoo       124\nChinstrap     68\nName: count, dtype: int64\n```\n:::\n:::\n\n\n## `kind` argument in `plot()`\n\nAt the beginning of the lesson we talked about how the `plot()` method creates a line plot by default. The parameter that controls this behaviour is the `kind` parameter. By changing the value of `kind` we can create different kinds of plots. Let's look at the documentation to see what these values are:\n\n![Extract from the `pandas.DataFrame.plot` documentation. Accessed on Sept 25,2024](/book/images/lesson-4/df-plot-doc.png)\n\nNotice the default value of `kind` is `'line'`. \n\nLet's change the `kind` parameter to create some different plots. \n\n## Scatter plots\nSuppose we want to visualy compare the flipper length against the body mass, we can do this with a scatterplot: \n\n::: {#715b04bb .cell execution_count=18}\n``` {.python .cell-code}\npenguins.plot(kind='scatter',\n              x='flipper_length_mm', \n              y='body_mass_g')\n```\n\n::: {.cell-output .cell-output-display}\n![](lesson-4-plotting-pandas_files/figure-html/cell-19-output-1.png){width=602 height=429}\n:::\n:::\n\n\nWe can update some other arguments to customize the graph:\n\n::: {#0bf2f694 .cell execution_count=19}\n``` {.python .cell-code}\npenguins.plot(kind='scatter',\n              x='flipper_length_mm', \n              y='body_mass_g',\n              title='Flipper length and body mass for Palmer penguins',\n              xlabel='Flipper length (mm)',\n              ylabel='Body mass (g)',\n              color='#ff3b01',\n              alpha=0.4  # Controls transparency\n              )\n```\n\n::: {.cell-output .cell-output-display}\n![](lesson-4-plotting-pandas_files/figure-html/cell-20-output-1.png){width=602 height=449}\n:::\n:::\n\n\n## Bar plots\n\nWe can create bar plots of our data setting `kind='bar'` in the `plot()` method.\n\nFor example, let's say we want to get data about the 10 penguins with lowest body mass. We can first select this data using the `nsmallest()` method for series:\n\n::: {#4cec9627 .cell execution_count=20}\n``` {.python .cell-code}\nsmallest = penguins.body_mass_g.nsmallest(10).sort_values()\nsmallest\n```\n\n::: {.cell-output .cell-output-display execution_count=20}\n```\n314    2700.0\n58     2850.0\n64     2850.0\n54     2900.0\n98     2900.0\n116    2900.0\n298    2900.0\n104    2925.0\n47     2975.0\n44     3000.0\nName: body_mass_g, dtype: float64\n```\n:::\n:::\n\n\nWe can then plot this data as a bar plot\n\n::: {#385c0969 .cell execution_count=21}\n``` {.python .cell-code}\nsmallest.plot(kind='bar')\n```\n\n::: {.cell-output .cell-output-display}\n![](lesson-4-plotting-pandas_files/figure-html/cell-22-output-1.png){width=583 height=424}\n:::\n:::\n\n\nIf we wanted to look at other data for these smallest penguins we can use the index of the `smallest` `pandas.Series` to select those rows in the original `penguins` data frame using `loc`:\n\n::: {#d2f02fb3 .cell execution_count=22}\n``` {.python .cell-code}\npenguins.loc[smallest.index]\n```\n\n::: {.cell-output .cell-output-display execution_count=22}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>species</th>\n      <th>island</th>\n      <th>bill_length_mm</th>\n      <th>bill_depth_mm</th>\n      <th>flipper_length_mm</th>\n      <th>body_mass_g</th>\n      <th>sex</th>\n      <th>year</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>314</th>\n      <td>Chinstrap</td>\n      <td>Dream</td>\n      <td>46.9</td>\n      <td>16.6</td>\n      <td>192.0</td>\n      <td>2700.0</td>\n      <td>female</td>\n      <td>2008</td>\n    </tr>\n    <tr>\n      <th>58</th>\n      <td>Adelie</td>\n      <td>Biscoe</td>\n      <td>36.5</td>\n      <td>16.6</td>\n      <td>181.0</td>\n      <td>2850.0</td>\n      <td>female</td>\n      <td>2008</td>\n    </tr>\n    <tr>\n      <th>64</th>\n      <td>Adelie</td>\n      <td>Biscoe</td>\n      <td>36.4</td>\n      <td>17.1</td>\n      <td>184.0</td>\n      <td>2850.0</td>\n      <td>female</td>\n      <td>2008</td>\n    </tr>\n    <tr>\n      <th>54</th>\n      <td>Adelie</td>\n      <td>Biscoe</td>\n      <td>34.5</td>\n      <td>18.1</td>\n      <td>187.0</td>\n      <td>2900.0</td>\n      <td>female</td>\n      <td>2008</td>\n    </tr>\n    <tr>\n      <th>98</th>\n      <td>Adelie</td>\n      <td>Dream</td>\n      <td>33.1</td>\n      <td>16.1</td>\n      <td>178.0</td>\n      <td>2900.0</td>\n      <td>female</td>\n      <td>2008</td>\n    </tr>\n    <tr>\n      <th>116</th>\n      <td>Adelie</td>\n      <td>Torgersen</td>\n      <td>38.6</td>\n      <td>17.0</td>\n      <td>188.0</td>\n      <td>2900.0</td>\n      <td>female</td>\n      <td>2009</td>\n    </tr>\n    <tr>\n      <th>298</th>\n      <td>Chinstrap</td>\n      <td>Dream</td>\n      <td>43.2</td>\n      <td>16.6</td>\n      <td>187.0</td>\n      <td>2900.0</td>\n      <td>female</td>\n      <td>2007</td>\n    </tr>\n    <tr>\n      <th>104</th>\n      <td>Adelie</td>\n      <td>Biscoe</td>\n      <td>37.9</td>\n      <td>18.6</td>\n      <td>193.0</td>\n      <td>2925.0</td>\n      <td>female</td>\n      <td>2009</td>\n    </tr>\n    <tr>\n      <th>47</th>\n      <td>Adelie</td>\n      <td>Dream</td>\n      <td>37.5</td>\n      <td>18.9</td>\n      <td>179.0</td>\n      <td>2975.0</td>\n      <td>NaN</td>\n      <td>2007</td>\n    </tr>\n    <tr>\n      <th>44</th>\n      <td>Adelie</td>\n      <td>Dream</td>\n      <td>37.0</td>\n      <td>16.9</td>\n      <td>185.0</td>\n      <td>3000.0</td>\n      <td>female</td>\n      <td>2007</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n## Histograms\n\nWe can create a histogram of our data setting `kind='hist'` in `plot()`. \n\n::: {#f4a3f4a0 .cell execution_count=23}\n``` {.python .cell-code}\n# Using plot without subsetting data - a mess again\npenguins.plot(kind='hist')\n```\n\n::: {.cell-output .cell-output-display}\n![](lesson-4-plotting-pandas_files/figure-html/cell-24-output-1.png){width=593 height=411}\n:::\n:::\n\n\nTo gain actual information, let's subset the data before plotting it. For example, suppose we want to do a preliminary graph for the distribution of flipper length. We could do it in this way:\n\n::: {#6a216bf8 .cell execution_count=24}\n``` {.python .cell-code}\n# Distribution of flipper length measurements\n# First select data, then plot\npenguins['flipper_length_mm'].plot(kind='hist',\n                                title='Penguin flipper lengths',\n                                xlabel='Flipper length (mm)',\n                                grid=True)\n```\n\n::: {.cell-output .cell-output-display}\n![](lesson-4-plotting-pandas_files/figure-html/cell-25-output-1.png){width=585 height=449}\n:::\n:::\n\n\n:::{.callout-tip}\n## Check-in\n1. Select the `bill_length_mm` and `bill_depth_mm` columns in the `penguins` dataframe and then update the kind parameter to `box` to make boxplots of the bill length and bill depth.\n<!--\n\n::: {#fadb6081 .cell execution_count=25}\n``` {.python .cell-code}\npenguins[['bill_length_mm','bill_depth_mm']].plot(kind='box')\n```\n\n::: {.cell-output .cell-output-display}\n![](lesson-4-plotting-pandas_files/figure-html/cell-26-output-1.png){width=566 height=411}\n:::\n:::\n\n\n-->\n<!--\n2. Select both rows and columns to create a histogram of the flipper length of gentoo penguins. \n\n::: {#01f54df4 .cell execution_count=26}\n``` {.python .cell-code}\npenguins.loc[penguins.species == 'Gentoo', 'flipper_length_mm'].plot(kind='hist')\n```\n\n::: {.cell-output .cell-output-display}\n![](lesson-4-plotting-pandas_files/figure-html/cell-27-output-1.png){width=597 height=411}\n:::\n:::\n\n\n-->\n\n2. Create a histogram of the flipper length of female gentoo penguins.\n<!--\n\n::: {#bdd601c2 .cell execution_count=27}\n``` {.python .cell-code}\npenguins.loc[(penguins.species == 'gentoo') & (penguins.sex == 'female'), 'flipper_length_mm'].plot(kind='hist')\n```\n\n::: {.cell-output .cell-output-display}\n![](lesson-4-plotting-pandas_files/figure-html/cell-28-output-1.png){width=609 height=411}\n:::\n:::\n\n\n-->\n:::\n\n",
    "supporting": [
      "lesson-4-plotting-pandas_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}